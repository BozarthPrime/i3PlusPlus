#!/usr/bin/env bash
#
# mfnew
#
<<<<<<< HEAD
# Create a new branch based on RCBugFix or dev a given branch name
#

MFINFO=$(mfinfo) || exit
IFS=' ' read -a INFO <<< "$MFINFO"
TARG=${INFO[3]}

if [[ ${INFO[4]} == "(no" ]]; then
  echo "Branch is unavailable!"
  exit 1
fi

case "$#" in
  0 ) BRANCH=pr_for_$TARG-$(date +"%G-%d-%m|%H:%M:%S") ;;
  1 ) BRANCH=$1 ;;
  * ) echo "Usage: `basename $0` [branch]" 1>&2 ; exit 1 ;;
esac

git checkout $TARG -b $BRANCH
=======
# Create a new branch from the default target with the given name
#

usage() {
  echo "Usage: `basename $0` [1|2] [name]" 1>&2
}

[[ $# < 3 && $1 != "-h" && $1 != "--help" ]] || { usage; exit 1; }

MFINFO=$(mfinfo "$@") || exit 1
IFS=' ' read -a INFO <<< "$MFINFO"
TARG=${INFO[3]}
BRANCH=pr_for_$TARG-$(date +"%G-%m-%d_%H.%M.%S")

# BRANCH can be given as the last argument
case "$#" in
  1 ) case "$1" in
        1|2) ;;
        *) BRANCH=$1 ;;
      esac
      ;;
  2 ) case "$1" in
        1|2) BRANCH=$2 ;;
        *) usage ; exit 1 ;;
      esac
      ;;
esac

git fetch upstream
git checkout --no-track upstream/$TARG -b $BRANCH
>>>>>>> upstream-marlin/1.1.x
